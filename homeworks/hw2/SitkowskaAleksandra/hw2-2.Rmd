---
title: "Praca domowa 2"
author: "Imię Nazwisko - Aleksandra Sitkowska"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
    theme: united

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(tidyr)

### Wczytanie danych
df <- read.csv("StudentsPerformance.csv")

```

## Dane 
Dane wykorzystane w Pracy domowej 2 dotyczą wyników egzaminów z 3 umiejętności: czytania, pisania i operacji matematycznych. Dodatkowo dostępne są podstawowe informacje o studentach i ich rodzicach. Opis wszystkich kolumn znajduje się również w pliku `README.md`.

#### 
|Zmienna|Opis|
|-|-|
| **gender**| płeć|
|**race.ethnicity**| pochodzenie etniczne |
|**parental.level.of.education**| wykształcenie rodziców |
|**lunch**| jaki obiad jedli uczniowie w dniu egzaminu|
|**test.preparation.course**| czy uczeń odbył kurs przygotowujący |
|**math.score**| wynik egzaminu z matematyki |
|**reading.score** | wynik egzaminu z czytania |
|**writing.score** | wynik egzaminu z pisania|



## Zadanie 1

Jak wyglądają rozkłady wyników uczniów z trzech przedmiotów (matematyka, czytanie, pisanie)?


```{r zadanie 1, message=FALSE}

# Tu umieść kod do wygenerowania odpowiedzi do zadania.

df2 <- df %>% 
  rename(Math = math.score, Reading = reading.score, Writing = writing.score)

df_long <- df2 %>%
  pivot_longer(cols = c(Math, Reading, Writing),
               names_to = "subject", values_to = "score")

df_long %>% 
  ggplot(aes(x = subject, y = score, fill = subject)) +
  geom_boxplot(alpha = 0.7) +
  theme_minimal() +
  labs(title = "Distribution of students’ scores across three subjects",
       x = "Subject", y = "Score") +
  scale_fill_brewer(palette = "Set1")

```

**Komentarz:**
Uczniowie osiągają najsłabsze wyniki z matematyki, natomiast wyniki z czytania i pisania są zbliżone i nieco wyższe. Różnice między przedmiotami nie są jednak duże — mediana wyników z matematyki jest tylko o kilka punktów procentowych niższa niż z przedmiotów humanistycznych.

## Zadanie 2

Czy istnieje zauważalna różnica w wynikach między uczniami i uczennicami?


```{r zadanie 2, message=FALSE}

# Tu umieść kod do wygenerowania odpowiedzi do zadania.
ggplot(df_long, aes(x = subject, y = score, fill = gender)) +
  geom_boxplot(alpha = 0.7, position = position_dodge(width = 0.8)) +
  theme_minimal() +
  labs(title = "Students’ Scores by Gender",
       x = "Subject", y = "Score", fill = "Sex") +
  scale_fill_brewer(palette = "Set1")
```

**Komentarz:**
Tak, łatwo zauważyc, że uczniowie radzą sobie lepiej z matematyką a uczennice z przedmiotami humanistycznymi takimi jak czytanie i pisanie. Dodatkowo dziewczynki częściej mają wyniki bardzo niskie, znacząco odstające od reszty.

## Zadanie 3

Czy uczniowie, którzy ukończyli kurs przygotowawczy, osiągają lepsze wyniki niż pozostali?

```{r zadanie 3, message=FALSE}

# Tu umieść kod do wygenerowania odpowiedzi do zadania.
ggplot(df_long, aes(x = test.preparation.course, y = score, fill = test.preparation.course)) +
  geom_violin(trim = FALSE, alpha = 0.7) +
  geom_boxplot(width = 0.1, fill = "white", outlier.shape = NA) +
  facet_wrap(~ subject) +
  theme_minimal() +
  labs(
    title = "Scores by Preparatory Course Completion",
    x = "Course",
    y = "Score",
    fill = "Course"
  )+
  scale_fill_brewer(palette = "Dark2")

```

**Komentarz:**
Tak, uczniowie, którzy ukończyli kurs przygotowawczy, zazwyczaj osiągają lepsze wyniki niż pozostali. Różnice są szczególnie widoczne wśród wyników przeciętnych (bliskich medianie) oraz w grupie uczniów z najsłabszymi rezultatami.

## Zadanie 4

 Jaki jest związek między poziomem wykształcenia rodziców a średnimi wynikami uczniów?

```{r zadanie 4, message=FALSE}

# Tu umieść kod do wygenerowania odpowiedzi do zadania.
df_summary <- df_long %>%
  group_by(parental.level.of.education, subject) %>%
  summarise(
    mean_score = mean(score, na.rm = TRUE),
    se = sd(score, na.rm = TRUE) / sqrt(n()),
    .groups = "drop"
  ) %>%
  arrange(parental.level.of.education, subject)

df_summary$parental.level.of.education <- factor(
  df_summary$parental.level.of.education,
  levels = c("some high school",
             "high school",
             "some college",
             "associate's degree",
             "bachelor's degree",
             "master's degree"),
  ordered = TRUE
)

ggplot(df_summary, aes(x = parental.level.of.education, y = mean_score, fill = subject)) +
  geom_col(position = position_dodge(width = 0.8)) +
  geom_errorbar(
    aes(ymin = mean_score - se, ymax = mean_score + se),
    width = 0.2,
    position = position_dodge(width = 0.8)
  ) +
  theme_minimal() +
  labs(
    title = "Parental Education vs Students’ Average Scores",
    x = "Parents' education level",
    y = "Average score",
    fill = "Subject"
  ) +
  scale_fill_brewer(palette = "Set1") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))
```

**Komentarz:**
Im wyższe wykształcenie rodziców tym wyższe wyniki osiągają uczniowie. Dotyczy to każdego z 3 przedmiotów

## Zadanie 5

Czy płeć i wykształcenie rodzica wpływa na wynik z matematyki? 


```{r zadanie 5, message=FALSE}

# Tu umieść kod do wygenerowania odpowiedzi do zadania.
df2$parental.level.of.education <- factor(df2$parental.level.of.education,
  levels = c("some high school", "high school", "some college",
             "associate's degree", "bachelor's degree", "master's degree"),
  ordered = TRUE
)


ggplot(df2, aes(x = parental.level.of.education, y = Math, fill = gender)) +
  geom_boxplot(alpha = 0.7, position = position_dodge(width = 0.8)) +
  theme_minimal() +
  labs(
    title = "Gender & Parental Education vs Math Scores",
    x = "Parents' education level",
    y = "Math score",
    fill = "Sex"
  ) +
  scale_fill_brewer(palette = "Set1") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))
```

**Komentarz:**
Na wykresie widać, że wraz ze wzrostem poziomu wykształcenia rodziców rosną średnie wyniki uczniów z matematyki. Uczniowie, których rodzice ukończyli studia licencjackie lub magisterskie, osiągają wyższe wyniki niż ci, których rodzice mają jedynie wykształcenie średnie lub niższe. Ponadto chłopcy  mają zazwyczaj nieco wyższe mediany wyników z matematyki niż dziewczęta, niezależnie od poziomu wykształcenia rodziców.
## Zadanie 6
Czy istnieje zależność między wynikami z matematyki a wynikami z czytania lub pisania?

```{r zadanie 6, message=FALSE}

# Tu umieść kod do wygenerowania odpowiedzi do zadania.
# matematyka vs czytanie
p1 <- ggplot(df2, aes(x = Reading, y = Math)) +
  geom_point(alpha = 0.6, color = "#1f77b4") +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  theme_minimal() +
  labs(
    title = "Math score vs reading score",
    x = "Reading score",
    y = "Math score"
  )

# matematyka vs pisanie
p2 <- ggplot(df2, aes(x = Writing, y = Math)) +
  geom_point(alpha = 0.6, color = "#2ca02c") +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  theme_minimal() +
  labs(
    title = "Math score vs writing score",
    x = "Writing score",
    y = "Math score"
  )

library(patchwork)
p1 + p2

```

**Komentarz:**
Na obu wykresach punkty układają się wzdłuż prostej y = x, co wskazuje na dodatnią zależność między wynikami z matematyki a wynikami z czytania oraz pisania. Oznacza to, że uczniowie uzyskujący wysokie wyniki z matematyki zwykle osiągają również dobre rezultaty w pozostałych dwóch przedmiotach. Zależność ta sugeruje ogólną spójność kompetencji akademickich uczniów.